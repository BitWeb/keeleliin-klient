
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>{{service.name || 'Uus teenus'}}</h2>
        <ol class="breadcrumb">
            <li>
                <a ui-sref="home">Avaleht</a>
            </li>
            <li>
                <a ui-sref="services">Teenuste haldus</a>
            </li>
            <li class="active">
                <strong>{{service.name || 'Uus teenus'}} </strong>
            </li>
        </ol>
    </div>
</div>
<div class="row">
    <form name="serviceForm" role="form" novalidate>
        <div class="wrapper wrapper-content animated fadeInUp">
        <div class="ibox">
            <div class="ibox-content">
                <fieldset class="form-horizontal">
                    <div ng-class="{'has-error': serviceForm.name.$invalid && serviceForm.submitted,  'form-group': true}">
                        <label class="col-sm-2 control-label">Nimetus*:</label>
                        <div class="col-sm-10">
                            <input name="name" ng-model="service.name" type="text" class="form-control" placeholder="Teenuse nimetus" required>
                            <i ng-show="serviceForm.name.$error.required && serviceForm.submitted">Väli on nõutud</i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Kirjeldus:</label>
                        <div class="col-sm-10">
                            <textarea name="description" ng-model="service.description" class="form-control" placeholder="Teenuse kirjeldus"></textarea>
                        </div>
                    </div>
                    <div ng-class="{'has-error': serviceForm.url.$invalid && serviceForm.submitted,  'form-group': true}">
                        <label class="col-sm-2 control-label">Teenuse URL*:</label>
                        <div class="col-sm-10">
                            <input name="url" ng-model="service.url" type="text" class="form-control" placeholder="Teenuse URL" required>
                            <i ng-show="serviceForm.url.$error.required && serviceForm.submitted">Väli on nõutud</i>
                        </div>
                    </div>
                    <div ng-class="{'has-error': serviceForm.sid.$invalid && serviceForm.submitted,  'form-group': true}">
                        <label class="col-sm-2 control-label">Lühinimi*:</label>
                        <div class="col-sm-4">
                            <input name="sid" ng-model="service.sid" type="text" class="form-control" placeholder="Lühinimi" required>
                            <i ng-show="serviceForm.sid.$error.required && serviceForm.submitted">Väli on nõutud</i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Paralleelne:</label>
                        <div class="col-sm-4">
                            <input icheck type="checkbox" name="isParallel" ng-model="service.isParallel" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Aktiveeritud:</label>
                        <div class="col-sm-4">
                            <input icheck type="checkbox" name="isActive" ng-model="service.isActive"  >
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Eelnevad teenused TODO:</label>
                        <div class="col-sm-10">
                            <select multiple chosen class="chosen-select m-t-md form-control" style="width:100%;" tabindex="4" data-placeholder="Määra võimalikud teenused">
                                <option value="Teenus 1">Teenus 1</option>
                                <option value="Teenus 3">Teenus 3</option>
                                <option value="Teenus 5">Teenus 5</option>
                                <option value="Teenus 8">Teenus 8</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Parameetrid :</label>
                        <div class="col-sm-8">
                            <button ng-click="addServiceParam()" class="btn btn-white"><i class="fa fa-plus"></i> Lisa parameeter</button>
                            <div class="table-responsive m-t-sm">
                                <table class="table table-bordered table-stripped">
                                    <thead>
                                    <tr>
                                        <th width="100px">
                                            Tüüp
                                        </th>
                                        <th>
                                            Kirjeldus
                                        </th>
                                        <th>
                                            Võti
                                        </th>
                                        <th>Väärtus</th>
                                        <th width="60">
                                            Muudetav
                                        </th>
                                        <th width="30"></th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <tr ng-repeat="serviceParam in service.serviceParams">
                                        <td>
                                            <select name="type" ng-model="serviceParam.type" class="form-control input-sm">
                                                <option value="select">Valik</option>
                                                <option value="text">Tekst</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input name="description" ng-model="serviceParam.description" type="text" class="form-control input-sm" placeholder="Kirjeldus">
                                        </td>
                                        <td>
                                            <input name="key" ng-model="serviceParam.key" type="text" class="form-control" placeholder="Võti">
                                        </td>
                                        <td>
                                            <div ng-if="serviceParam.type == 'text'">
                                                <input name="value" ng-model="serviceParam.value" type="text" class="form-control" placeholder="Väärtus">
                                            </div>
                                            <div ng-if="serviceParam.type == 'select'">

                                                <div class="row m-b-sm">
                                                    <div class="col-md-10 p-r-none">
                                                        <input name="value" ng-model="serviceParam.value" type="text" class="form-control" placeholder="Väärtus">
                                                    </div>
                                                    <div class="col-md-1">
                                                        <a ng-click="addParamOption(serviceParam)" href="" class="btn btn-white btn-sm" title="Lisa valik">
                                                            <i class="fa fa-plus"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div ng-repeat="(optionIndex, option) in serviceParam.paramOptions" class="row m-b-sm">
                                                    <div class="col-md-5 p-r-none">
                                                        <input ng-model="option.value" type="text" placeholder="Väärtus" class="form-control">
                                                    </div>
                                                    <div class="col-md-5 p-r-none">
                                                        <input ng-model="option.label" type="text" placeholder="Nimetus" class="form-control">
                                                    </div>
                                                    <div class="col-md-2">
                                                        <a ng-click="removeParamOption(serviceParam, optionIndex)" href="" class="btn btn-white btn-sm" title="Kustuta valik"><i class="fa fa-trash"></i></a>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="text-center">
                                            <input name="isEditable" ng-model="serviceParam.isEditable" icheck type="checkbox" />
                                        </td>
                                        <td>
                                            <button ng-click="removeServiceParam($index)" class="btn btn-white btn-sm" title="Kustuta parameeter">
                                                <i class="fa fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Sisendressursid*:</label>
                        <div class="col-sm-8">
                            <button ng-click="addServiceInputType()" class="btn btn-white"><i class="fa fa-plus"></i> Lisa sisendi tüüp</button>
                            <div class="table-responsive m-t-sm">
                                <table class="table table-bordered table-stripped">
                                    <thead>
                                        <tr>
                                            <th width="100px">
                                                Võti
                                            </th>
                                            <th>
                                                Ressursi tüüp
                                            </th>
                                            <th width="30"></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="inputType in service.serviceInputTypes">
                                            <td>
                                                <input name="key" ng-model="inputType.key" type="text" class="form-control" placeholder="Võti">
                                            </td>
                                            <td>
                                                <div class=" m-b-sm ">
                                                    <select
                                                            name="type"
                                                            ng-model="inputType.resourceTypeId"
                                                            class="form-control input-sm"
                                                            ng-options="resourceType.id as resourceType.name for resourceType in resourceTypes"
                                                            ng-change="inputResourceTypeUpdated( inputType )"
                                                            >
                                                    </select>
                                                </div>


                                                <div ng-if="canDoParallel(inputType)" class="row m-b-sm">
                                                    <div class="col-md-12 m-b-sm">
                                                        <input name="isParallel" ng-model="inputType.isParallel" icheck type="checkbox" /> Tee paraleelseks
                                                    </div>
                                                    <div ng-if="inputType.isParallel">
                                                        <div class="col-md-6 p-r-none">
                                                            <input ng-model="inputType.sizeLimit" type="text" placeholder="Suuruse piir" class="form-control input-sm" >
                                                        </div>
                                                        <div class="col-md-6">
                                                            <select ng-model="inputType.sizeUnit" class="form-control input-sm">
                                                                <option value="byte">Baiti</option>
                                                                <option value="line">Rida</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <button ng-click="removeServiceInputType($index)" class="btn btn-white btn-sm" title="Kustuta sisendi tüüp">
                                                    <i class="fa fa-trash"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Väljundressursid*:</label>
                        <div class="col-sm-8">
                            <button ng-click="addServiceOutputType()" class="btn btn-white"><i class="fa fa-plus"></i> Lisa väljundi tüüp</button>
                            <div class="table-responsive m-t-sm">
                                <table class="table table-bordered table-stripped">
                                    <thead>
                                    <tr>
                                        <th width="100px">
                                            Võti
                                        </th>
                                        <th>
                                            Ressursi tüüp
                                        </th>
                                        <th width="30"></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="outputType in service.serviceOutputTypes">
                                        <td>
                                            <input name="key" ng-model="outputType.key" type="text" class="form-control" placeholder="Võti">
                                        </td>
                                        <td>
                                            <div class=" m-b-sm ">
                                                <select
                                                        name="type"
                                                        ng-model="outputType.resourceTypeId"
                                                        class="form-control input-sm"
                                                        ng-options="resourceType.id as resourceType.name for resourceType in resourceTypes"

                                                        >
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <button ng-click="removeServiceOutputType($index)" class="btn btn-white btn-sm" title="Kustuta väljundi tüüp">
                                                <i class="fa fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>



                </fieldset>
            </div>

            <div class="ibox-footer text-right ng-scope">
                <a ui-sref="services" class="btn btn-sm btn-link pull-left"><i class="fa fa-caret-left"></i> Tagasi teenuste nimekirja</a>
                <a ng-if="service.id" class="btn btn-danger btn-sm m-r-lg"><i class="fa fa-trash"></i> Kustuta teenus</a>
                <a ng-click="saveService(serviceForm)" class="btn btn-primary btn-sm"><i class="fa fa-save"></i> Salvesta</a>
            </div>
        </div>
    </div>
    </form>
</div>